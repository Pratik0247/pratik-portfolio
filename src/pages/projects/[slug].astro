---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { data } = entry;
const { Content } = await entry.render();
---

<BaseLayout title={data.title}>
  <article class="space-y-16">
    <!-- Hero -->
    <header class="space-y-4 text-center">
      <h1 class="text-4xl font-bold tracking-tight">{data.title}</h1>
      {data.timeframe && <p class="text-sm text-white/60">{data.timeframe}</p>}
      {
        data.summary && (
          <p class="text-lg text-white/80 max-w-2xl mx-auto leading-relaxed">
            {data.summary}
          </p>
        )
      }
    </header>

    <!-- Impact highlights -->
    {
      data.impact && data.impact.length > 0 && (
        <section class="max-w-3xl mx-auto">
          <div class="grid gap-4 sm:grid-cols-2">
            {data.impact.map((point) => (
              <div class="rounded-2xl border border-white/10 bg-white/5 px-5 py-4 text-sm text-white/90 shadow-sm">
                {point}
              </div>
            ))}
          </div>
        </section>
      )
    }

    <!-- Case study content -->
    <section class="max-w-4xl mx-auto space-y-12">
      {
        entry.body ? (
          <Content />
        ) : (
          <p class="text-white/70 leading-relaxed">{data.summary}</p>
        )
      }
    </section>

    <!-- Links -->
    {
      (data.repoUrl || data.demoUrl || data.reportPdf) && (
        <section class="max-w-3xl mx-auto flex flex-wrap gap-4 pt-8 border-t border-white/10">
          {data.repoUrl && (
            <a
              href={data.repoUrl}
              class="px-4 py-2 rounded-xl border border-white/20 bg-white/5 text-sm hover:bg-white/10 transition"
            >
              GitHub Repo
            </a>
          )}
          {data.demoUrl && (
            <a
              href={data.demoUrl}
              class="px-4 py-2 rounded-xl border border-white/20 bg-white/5 text-sm hover:bg-white/10 transition"
            >
              Demo Video
            </a>
          )}
          {data.reportPdf && (
            <a
              href={data.reportPdf}
              class="px-4 py-2 rounded-xl border border-white/20 bg-white/5 text-sm hover:bg-white/10 transition"
            >
              Final Report
            </a>
          )}
        </section>
      )
    }

    <!-- Back to projects -->
    <div class="text-center pt-12">
      <a href="/projects" class="text-sm text-sky-400 hover:underline">
        ‚Üê Back to all projects
      </a>
    </div>
  </article>
</BaseLayout>
