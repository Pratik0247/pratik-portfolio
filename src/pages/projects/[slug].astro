---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { data } = entry;
const { Content } = await entry.render();
---
<BaseLayout title={data.title}>
  <article class="space-y-16">
    <!-- Hero -->
    <header class="space-y-4 text-center">
      <h1 class="text-4xl font-extrabold tracking-tight text-[var(--ghost-white)]">
        {data.title}
      </h1>
      {data.timeframe && (
        <p class="text-sm text-[var(--light-blue)]">{data.timeframe}</p>
      )}
      {data.summary && (
        <p class="text-lg text-[var(--light-blue)] max-w-2xl mx-auto leading-relaxed">
          {data.summary}
        </p>
      )}
    </header>

    <!-- Impact highlights -->
    {data.impact && data.impact.length > 0 && (
      <section class="max-w-3xl mx-auto">
        <div class="grid gap-4 sm:grid-cols-2">
          {data.impact.map((point) => (
            <div
              class="rounded-xl 
                     bg-[var(--color-surface-blur)] 
                     backdrop-blur-md 
                     border border-[var(--paynes-gray)]/30 
                     shadow-md shadow-black/40 
                     px-4 py-3 text-sm text-[var(--light-blue)]"
            >
              {point}
            </div>
          ))}
        </div>
      </section>
    )}

    <!-- Case study content -->
    <section class="max-w-4xl mx-auto space-y-12 prose prose-invert prose-headings:font-bold prose-h2:text-2xl prose-h2:text-[var(--ghost-white)] prose-p:text-[var(--light-blue)] prose-li:text-[var(--light-blue)]">
      <Content />
    </section>

    <!-- Links -->
    {(data.repoUrl || data.demoUrl || data.reportPdf) && (
      <section class="max-w-3xl mx-auto flex flex-wrap gap-4 pt-8 border-t border-[var(--paynes-gray)]/30">
        {data.repoUrl && (
          <a
            href={data.repoUrl}
            class="px-4 py-2 rounded-xl 
                   border border-[var(--paynes-gray)]/30 
                   bg-[var(--color-surface-blur)] 
                   text-sm text-[var(--light-blue)] 
                   hover:border-[var(--light-blue)] 
                   hover:text-[var(--ghost-white)] 
                   transition"
          >
            GitHub Repo
          </a>
        )}
        {data.demoUrl && (
          <a
            href={data.demoUrl}
            class="px-4 py-2 rounded-xl 
                   border border-[var(--paynes-gray)]/30 
                   bg-[var(--color-surface-blur)] 
                   text-sm text-[var(--light-blue)] 
                   hover:border-[var(--light-blue)] 
                   hover:text-[var(--ghost-white)] 
                   transition"
          >
            Demo Video
          </a>
        )}
        {data.reportPdf && (
          <a
            href={data.reportPdf}
            class="px-4 py-2 rounded-xl 
                   border border-[var(--paynes-gray)]/30 
                   bg-[var(--color-surface-blur)] 
                   text-sm text-[var(--light-blue)] 
                   hover:border-[var(--light-blue)] 
                   hover:text-[var(--ghost-white)] 
                   transition"
          >
            Final Report
          </a>
        )}
      </section>
    )}

    <!-- Back to projects -->
    <div class="text-center pt-12">
      <a href="/projects" class="text-sm text-[var(--light-blue)] hover:text-[var(--ghost-white)] hover:underline">
        ‚Üê Back to all projects
      </a>
    </div>
  </article>
</BaseLayout>
